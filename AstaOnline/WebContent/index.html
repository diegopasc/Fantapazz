<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>

<script type="text/javascript" src="jWebSocket.js"></script>
<script type="text/javascript" src="jwsSamplesPlugIn.js"></script>

<script type="text/javascript">

	//------------------------
	// Send message to server
	//------------------------
	sendMessage = function(path, opt_param) {
		if (opt_param) {
			path += '?' + opt_param;
		}
		var xhr = new XMLHttpRequest();
		xhr.open('POST', path, true);
		xhr.send();
	};
	
	//------------------------
	// Send message to server
	//------------------------
	onOpened = function() {
		sendMessage('/opened');
	};

	onMessage = function(m) {
		/*
		newState = JSON.parse(m.data);
		state.board = newState.board || state.board;
		state.userX = newState.userX || state.userX;
		state.userO = newState.userO || state.userO;
		state.moveX = newState.moveX == 'true';
		state.winner = newState.winner || "";
		state.winningBoard = newState.winningBoard || "";
		updateGame();
		*/
		alert(m);
	}
	
	var ws = null;

	openChannel = function() {
		ws = new WebSocket("ws://localhost:8080/AstaOnline/asta");
		ws.onopen = onOpened;
		ws.onmessage = onMessage;
		ws.onerror = function() { alert("error"); };
		ws.onclose = function() { alert("close"); };
		
		var socket = channel.open(handler);
		socket.onopen = onOpened;
		socket.onmessage = onMessage;
	}
	initialize = function() {
		openChannel();
		onMessage({
			data : '{{ initial_message }}'
		});
	}

	setTimeout(initialize, 100);
</script>"

<body>

	<h1>Hello!</h1>
	
	Ciao mamma

</body>
</html>